{"ast":null,"code":"import \"core-js/modules/es.number.to-fixed.js\";\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"agendamento\"\n};\nvar _hoisted_2 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_3 = {\n  key: 0,\n  \"class\": \"error-message\"\n};\nvar _hoisted_4 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_5 = {\n  key: 0,\n  \"class\": \"error-message\"\n};\nvar _hoisted_6 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_7 = [\"min\"];\nvar _hoisted_8 = {\n  key: 0,\n  \"class\": \"error-message\"\n};\nvar _hoisted_9 = {\n  key: 0,\n  \"class\": \"info-box\"\n};\nvar _hoisted_10 = {\n  \"class\": \"button-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_Toast = _resolveComponent(\"Toast\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[10] || (_cache[10] = _createElementVNode(\"h2\", null, \"Novo Agendamento de Transferência\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[5] || (_cache[5] = _withModifiers(function () {\n      return $setup.handleSubmit && $setup.handleSubmit.apply($setup, arguments);\n    }, [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_2, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    \"for\": \"contaDestino\"\n  }, \"Conta de Destino:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"contaDestino\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.form.contaDestino = $event;\n    }),\n    required: \"\",\n    pattern: \"[0-9]{10}\",\n    \"class\": _normalizeClass([\"form-control\", {\n      'error': $setup.errors.contaDestino\n    }])\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.contaDestino]]), $setup.errors.contaDestino ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, _toDisplayString($setup.errors.contaDestino), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_4, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    \"for\": \"valor\"\n  }, \"Valor da Transferência:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"valor\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.valorFormatado = $event;\n    }),\n    required: \"\",\n    \"class\": _normalizeClass([\"form-control\", {\n      'error': $setup.errors.valor\n    }]),\n    onInput: _cache[2] || (_cache[2] = function () {\n      return $setup.handleValorInput && $setup.handleValorInput.apply($setup, arguments);\n    }),\n    placeholder: \"R$ 0,00\"\n  }, null, 34 /* CLASS, NEED_HYDRATION */), [[_vModelText, $setup.valorFormatado]]), $setup.errors.valor ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString($setup.errors.valor), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_6, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    \"for\": \"dataTransferencia\"\n  }, \"Data e Hora da Transferência:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"datetime-local\",\n    id: \"dataTransferencia\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.form.dataTransferencia = $event;\n    }),\n    required: \"\",\n    min: $setup.minDateTime,\n    \"class\": _normalizeClass([\"form-control\", {\n      'error': $setup.errors.dataTransferencia\n    }])\n  }, null, 10 /* CLASS, PROPS */, _hoisted_7), [[_vModelText, $setup.form.dataTransferencia]]), $setup.errors.dataTransferencia ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString($setup.errors.dataTransferencia), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), $setup.taxaCalculada ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"p\", null, \"Taxa Estimada: R$ \" + _toDisplayString($setup.taxaCalculada.toFixed(2)), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_10, [_cache[9] || (_cache[9] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    \"class\": \"btn-primary\"\n  }, \"Agendar\", -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    type: \"button\",\n    onClick: _cache[4] || (_cache[4] = function () {\n      return $setup.limparFormulario && $setup.limparFormulario.apply($setup, arguments);\n    }),\n    \"class\": \"btn-secondary\"\n  }, \"Limpar\")])], 32 /* NEED_HYDRATION */), _createVNode(_component_Toast, {\n    show: $setup.toast.show.value,\n    message: $setup.toast.message.value,\n    type: $setup.toast.type.value\n  }, null, 8 /* PROPS */, [\"show\", \"message\", \"type\"])]);\n}","map":{"version":3,"names":["key","_createElementBlock","_hoisted_1","_createElementVNode","onSubmit","_cache","_withModifiers","$setup","handleSubmit","apply","arguments","_hoisted_2","type","id","$event","form","contaDestino","required","pattern","_normalizeClass","errors","_hoisted_3","_toDisplayString","_createCommentVNode","_hoisted_4","valorFormatado","valor","onInput","handleValorInput","placeholder","_hoisted_5","_hoisted_6","dataTransferencia","min","minDateTime","_hoisted_7","_hoisted_8","taxaCalculada","_hoisted_9","toFixed","_hoisted_10","onClick","limparFormulario","_createVNode","_component_Toast","show","toast","value","message"],"sources":["C:\\Users\\willi\\OneDrive\\Documentos\\GitHub\\FE-transfer-scheduler\\src\\views\\AgendamentoTransferencia.vue"],"sourcesContent":["<template>\n  <div class=\"agendamento\">\n    <h2>Novo Agendamento de Transferência</h2>\n    <form @submit.prevent=\"handleSubmit\">\n      <div class=\"form-group\">\n        <label for=\"contaDestino\">Conta de Destino:</label>\n        <input\n          type=\"text\"\n          id=\"contaDestino\"\n          v-model=\"form.contaDestino\"\n          required\n          pattern=\"[0-9]{10}\"\n          class=\"form-control\"\n          :class=\"{ 'error': errors.contaDestino }\"\n        >\n        <span class=\"error-message\" v-if=\"errors.contaDestino\">{{ errors.contaDestino }}</span>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"valor\">Valor da Transferência:</label>\n        <input\n          type=\"text\"\n          id=\"valor\"\n          v-model=\"valorFormatado\"\n          required\n          class=\"form-control\"\n          :class=\"{ 'error': errors.valor }\"\n          @input=\"handleValorInput\"\n          placeholder=\"R$ 0,00\"\n        >\n        <span class=\"error-message\" v-if=\"errors.valor\">{{ errors.valor }}</span>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"dataTransferencia\">Data e Hora da Transferência:</label>\n        <input\n          type=\"datetime-local\"\n          id=\"dataTransferencia\"\n          v-model=\"form.dataTransferencia\"\n          required\n          :min=\"minDateTime\"\n          class=\"form-control\"\n          :class=\"{ 'error': errors.dataTransferencia }\"\n        >\n        <span class=\"error-message\" v-if=\"errors.dataTransferencia\">{{ errors.dataTransferencia }}</span>\n      </div>\n\n      <div v-if=\"taxaCalculada\" class=\"info-box\">\n        <p>Taxa Estimada: R$ {{ taxaCalculada.toFixed(2) }}</p>\n      </div>\n\n      <div class=\"button-group\">\n        <button type=\"submit\" class=\"btn-primary\">Agendar</button>\n        <button type=\"button\" @click=\"limparFormulario\" class=\"btn-secondary\">Limpar</button>\n      </div>\n    </form>\n\n    <Toast\n      :show=\"toast.show.value\"\n      :message=\"toast.message.value\"\n      :type=\"toast.type.value\"\n    />\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport Toast from '@/components/Toast.vue'\nimport { useToast } from '@/composables/useToast'\n\nexport default {\n  name: 'AgendamentoTransferencia',\n  components: {\n    Toast\n  },\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const errors = ref({})\n    const toast = useToast()\n\n    const form = ref({\n      contaDestino: '',\n      valor: '',\n      dataTransferencia: ''\n    })\n\n    const valorFormatado = ref('')\n\n    const minDateTime = computed(() => {\n      const now = new Date()\n      return now.toISOString().slice(0, 16)\n    })\n\n    const calcularTaxa = (valor, dataTransferencia) => {\n      const hoje = new Date()\n      const dataTransferenciaObj = new Date(dataTransferencia)\n      const diffDias = Math.floor((dataTransferenciaObj - hoje) / (1000 * 60 * 60 * 24))\n\n      if (diffDias === 0) {\n        return 12 + (valor * 0.025)\n      } else if (diffDias >= 1 && diffDias <= 10) {\n        return 12\n      } else if (diffDias >= 11 && diffDias <= 20) {\n        return valor * 0.082\n      } else if (diffDias >= 21 && diffDias <= 30) {\n        return valor * 0.069\n      } else if (diffDias >= 31 && diffDias <= 40) {\n        return valor * 0.047\n      } else if (diffDias >= 41 && diffDias <= 50) {\n        return valor * 0.017\n      }\n      return null\n    }\n\n    const taxaCalculada = computed(() => {\n      if (!form.value.valor || !form.value.dataTransferencia) return null\n      return calcularTaxa(Number(form.value.valor), form.value.dataTransferencia)\n    })\n\n    const formatarValor = (valor) => {\n      if (typeof valor !== 'string') return 'R$ 0,00';\n\n      // Remove caracteres não numéricos\n      const apenasNumeros = valor.replace(/\\D/g, '');\n\n      // Garante pelo menos 3 dígitos para evitar problemas ao extrair centavos\n      const numeroComZeroEsquerda = apenasNumeros.padStart(3, '0');\n\n      // Separa centavos e reais\n      const centavos = numeroComZeroEsquerda.slice(-2);\n      const reais = numeroComZeroEsquerda.slice(0, -2);\n\n      // Formata os reais com separador de milhar\n      const reaisFormatados = Number(reais).toLocaleString('pt-BR');\n\n      return `R$ ${reaisFormatados},${centavos}`;\n    };\n\n    const handleValorInput = (event) => {\n      const valor = event.target.value\n      valorFormatado.value = formatarValor(valor)\n      \n      // Atualiza o valor no form (em centavos)\n      const numero = valor.replace(/\\D/g, '')\n      form.value.valor = numero ? Number(numero) / 100 : ''\n    }\n\n    const validarFormulario = () => {\n      errors.value = {}\n\n      if (form.value.contaDestino.length !== 10) {\n        errors.value.contaDestino = 'A conta de destino deve ter 10 dígitos'\n      }\n\n      if (form.value.contaDestino === store.state.auth.contaOrigem) {\n        errors.value.contaDestino = 'A conta de destino não pode ser igual à sua conta'\n      }\n\n      if (!form.value.valor || form.value.valor <= 0) {\n        errors.value.valor = 'O valor deve ser maior que zero'\n      }\n\n      if (!form.value.dataTransferencia) {\n        errors.value.dataTransferencia = 'A data e hora de transferência são obrigatórias'\n      } else if (new Date(form.value.dataTransferencia) < new Date()) {\n        errors.value.dataTransferencia = 'A data e hora de transferência não podem ser no passado'\n      }\n\n      return Object.keys(errors.value).length === 0\n    }\n\n    const handleSubmit = async () => {\n      if (!validarFormulario()) return\n\n      try {\n        const agendamento = {\n          contaDestino: form.value.contaDestino,\n          valor: Number(form.value.valor),\n          dataTransferencia: form.value.dataTransferencia\n        }\n\n        await store.dispatch('criarAgendamento', agendamento)\n        toast.success('Transferência agendada com sucesso!')\n        setTimeout(() => {\n          router.push('/agendamentos')\n        }, 1500)\n      } catch (error) {\n        toast.error(error.response?.data?.message || 'Erro ao agendar transferência')\n      }\n    }\n\n    const limparFormulario = () => {\n      form.value = {\n        contaDestino: '',\n        valor: '',\n        dataTransferencia: ''\n      }\n      valorFormatado.value = ''\n      errors.value = {}\n    }\n\n    return {\n      form,\n      errors,\n      minDateTime,\n      taxaCalculada,\n      valorFormatado,\n      handleValorInput,\n      handleSubmit,\n      limparFormulario,\n      toast\n    }\n  }\n}\n</script>\n\n<style scoped>\n.agendamento-container, .agendamento {\n  max-width: 600px;\n  width: 100%;\n  margin: 0 auto;\n  padding: 32px 24px;\n  background: var(--bg-secondary);\n  border-radius: var(--border-radius-lg);\n  box-shadow: var(--shadow-md);\n}\n\n.form-group {\n  margin-bottom: var(--spacing-lg);\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: var(--spacing-sm);\n  color: var(--text-primary);\n  font-weight: 500;\n}\n\n.form-control {\n  width: 100%;\n  padding: var(--spacing-sm);\n  border: 1px solid var(--border-color);\n  border-radius: var(--border-radius-sm);\n  background-color: var(--bg-secondary);\n  color: var(--text-primary);\n  transition: border-color 0.3s ease;\n}\n\n.form-control:focus {\n  outline: none;\n  border-color: var(--primary);\n}\n\n.form-control::placeholder {\n  color: var(--text-muted);\n}\n\n.error-message {\n  color: var(--danger);\n  font-size: 0.9em;\n  margin-top: var(--spacing-xs);\n}\n\n.btn-submit {\n  background-color: var(--primary);\n  color: white;\n  border: none;\n  padding: var(--spacing-sm) var(--spacing-md);\n  border-radius: var(--border-radius-sm);\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n  width: 100%;\n}\n\n.btn-submit:hover {\n  background-color: var(--primary-hover);\n}\n\n.btn-submit:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.loading {\n  color: var(--text-secondary);\n  text-align: center;\n  padding: var(--spacing-xl);\n}\n\n.button-group {\n  display: flex;\n  gap: 10px;\n  margin-top: 20px;\n}\n\n.btn-primary, .btn-secondary {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  flex: 1;\n}\n\n.btn-primary {\n  background-color: #42b983;\n  color: white;\n}\n\n.btn-secondary {\n  background-color: #666;\n  color: white;\n}\n\n.btn-primary:hover {\n  background-color: #3aa876;\n}\n\n.btn-secondary:hover {\n  background-color: #555;\n}\n\n.info-box {\n  background-color: #f8f9fa;\n  padding: 15px;\n  border-radius: 4px;\n  margin: 20px 0;\n  text-align: left;\n}\n</style> "],"mappings":";;;EACO,SAAM;AAAa;;EAGf,SAAM;AAAY;;EAJ7BA,GAAA;EAec,SAAM;;;EAGT,SAAM;AAAY;;EAlB7BA,GAAA;EA8Bc,SAAM;;;EAGT,SAAM;AAAY;iBAjC7B;;EAAAA,GAAA;EA4Cc,SAAM;;;EA5CpBA,GAAA;EA+CgC,SAAM;;;EAI3B,SAAM;AAAc;;;uBAlD7BC,mBAAA,CA6DM,OA7DNC,UA6DM,G,4BA5DJC,mBAAA,CAA0C,YAAtC,mCAAiC,sBACrCA,mBAAA,CAoDO;IApDAC,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAHjBC,cAAA;MAAA,OAG2BC,MAAA,CAAAC,YAAA,IAAAD,MAAA,CAAAC,YAAA,CAAAC,KAAA,CAAAF,MAAA,EAAAG,SAAA,CAAY;IAAA;MACjCP,mBAAA,CAYM,OAZNQ,UAYM,G,0BAXJR,mBAAA,CAAmD;IAA5C,OAAI;EAAc,GAAC,mBAAiB,sB,gBAC3CA,mBAAA,CAQC;IAPCS,IAAI,EAAC,MAAM;IACXC,EAAE,EAAC,cAAc;IAR3B,uBAAAR,MAAA,QAAAA,MAAA,gBAAAS,MAAA;MAAA,OASmBP,MAAA,CAAAQ,IAAI,CAACC,YAAY,GAAAF,MAAA;IAAA;IAC1BG,QAAQ,EAAR,EAAQ;IACRC,OAAO,EAAC,WAAW;IACnB,SAZVC,eAAA,EAYgB,cAAc;MAAA,SACDZ,MAAA,CAAAa,MAAM,CAACJ;IAAY;0CAJ7BT,MAAA,CAAAQ,IAAI,CAACC,YAAY,E,GAMMT,MAAA,CAAAa,MAAM,CAACJ,YAAY,I,cAArDf,mBAAA,CAAuF,QAAvFoB,UAAuF,EAAAC,gBAAA,CAA7Bf,MAAA,CAAAa,MAAM,CAACJ,YAAY,oBAfrFO,mBAAA,e,GAkBMpB,mBAAA,CAaM,OAbNqB,UAaM,G,0BAZJrB,mBAAA,CAAkD;IAA3C,OAAI;EAAO,GAAC,yBAAuB,sB,gBAC1CA,mBAAA,CASC;IARCS,IAAI,EAAC,MAAM;IACXC,EAAE,EAAC,OAAO;IAtBpB,uBAAAR,MAAA,QAAAA,MAAA,gBAAAS,MAAA;MAAA,OAuBmBP,MAAA,CAAAkB,cAAc,GAAAX,MAAA;IAAA;IACvBG,QAAQ,EAAR,EAAQ;IACR,SAzBVE,eAAA,EAyBgB,cAAc;MAAA,SACDZ,MAAA,CAAAa,MAAM,CAACM;IAAK;IAC9BC,OAAK,EAAAtB,MAAA,QAAAA,MAAA;MAAA,OAAEE,MAAA,CAAAqB,gBAAA,IAAArB,MAAA,CAAAqB,gBAAA,CAAAnB,KAAA,CAAAF,MAAA,EAAAG,SAAA,CAAgB;IAAA;IACxBmB,WAAW,EAAC;2DALHtB,MAAA,CAAAkB,cAAc,E,GAOSlB,MAAA,CAAAa,MAAM,CAACM,KAAK,I,cAA9CzB,mBAAA,CAAyE,QAAzE6B,UAAyE,EAAAR,gBAAA,CAAtBf,MAAA,CAAAa,MAAM,CAACM,KAAK,oBA9BvEH,mBAAA,e,GAiCMpB,mBAAA,CAYM,OAZN4B,UAYM,G,0BAXJ5B,mBAAA,CAAoE;IAA7D,OAAI;EAAmB,GAAC,+BAA6B,sB,gBAC5DA,mBAAA,CAQC;IAPCS,IAAI,EAAC,gBAAgB;IACrBC,EAAE,EAAC,mBAAmB;IArChC,uBAAAR,MAAA,QAAAA,MAAA,gBAAAS,MAAA;MAAA,OAsCmBP,MAAA,CAAAQ,IAAI,CAACiB,iBAAiB,GAAAlB,MAAA;IAAA;IAC/BG,QAAQ,EAAR,EAAQ;IACPgB,GAAG,EAAE1B,MAAA,CAAA2B,WAAW;IACjB,SAzCVf,eAAA,EAyCgB,cAAc;MAAA,SACDZ,MAAA,CAAAa,MAAM,CAACY;IAAiB;kCA1CrDG,UAAA,I,cAsCmB5B,MAAA,CAAAQ,IAAI,CAACiB,iBAAiB,E,GAMCzB,MAAA,CAAAa,MAAM,CAACY,iBAAiB,I,cAA1D/B,mBAAA,CAAiG,QAAjGmC,UAAiG,EAAAd,gBAAA,CAAlCf,MAAA,CAAAa,MAAM,CAACY,iBAAiB,oBA5C/FT,mBAAA,e,GA+CiBhB,MAAA,CAAA8B,aAAa,I,cAAxBpC,mBAAA,CAEM,OAFNqC,UAEM,GADJnC,mBAAA,CAAuD,WAApD,oBAAkB,GAAAmB,gBAAA,CAAGf,MAAA,CAAA8B,aAAa,CAACE,OAAO,oB,KAhDrDhB,mBAAA,gBAmDMpB,mBAAA,CAGM,OAHNqC,WAGM,G,0BAFJrC,mBAAA,CAA0D;IAAlDS,IAAI,EAAC,QAAQ;IAAC,SAAM;KAAc,SAAO,sBACjDT,mBAAA,CAAqF;IAA7ES,IAAI,EAAC,QAAQ;IAAE6B,OAAK,EAAApC,MAAA,QAAAA,MAAA;MAAA,OAAEE,MAAA,CAAAmC,gBAAA,IAAAnC,MAAA,CAAAmC,gBAAA,CAAAjC,KAAA,CAAAF,MAAA,EAAAG,SAAA,CAAgB;IAAA;IAAE,SAAM;KAAgB,QAAM,E,8BAIhFiC,YAAA,CAIEC,gBAAA;IAHCC,IAAI,EAAEtC,MAAA,CAAAuC,KAAK,CAACD,IAAI,CAACE,KAAK;IACtBC,OAAO,EAAEzC,MAAA,CAAAuC,KAAK,CAACE,OAAO,CAACD,KAAK;IAC5BnC,IAAI,EAAEL,MAAA,CAAAuC,KAAK,CAAClC,IAAI,CAACmC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}